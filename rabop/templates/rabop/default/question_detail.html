{% extends './base.html' %}

{% load i18n %}
{% load crispy_forms_tags %}
{% load help_tags %}

{% block content %}
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-header">
                    <div class="row mb-1">
                        <div class="col">
                            {% if question.owner and question.owner.profile %}
                                <a href="{% url 'rabop:customer-detail' store.code question.owner.profile.id %}">
                                    {{ question.owner.profile.full_name }}
                                </a>
                                {% if question.owner.profile.phone_verified_status == question.owner.profile.PHONE_VERIFIED_STATUS_CHOICES.verified %}
                                    <i class="fas fa-check fa-fw text-success"></i>
                                {% elif question.owner.profile.phone_verified_status == question.owner.profile.PHONE_VERIFIED_STATUS_CHOICES.unverified %}
                                    <i class="fas fa-times fa-fw text-danger"></i>
                                {% elif question.owner.profile.phone_verified_status == question.owner.profile.PHONE_VERIFIED_STATUS_CHOICES.revoked %}
                                    <i class="fas fa-lock fa-fw text-warning"></i>
                                {% endif %}
                                {% if question.owner.profile.document_verified %}
                                    <i class="fas fa-check text-success"></i>
                                {% else %}
                                    <i class="fas fa-times text-danger"></i>
                                {% endif %}
                                {% if question.owner.profile.phone %}
                                    {{ question.owner.profile.phone }}
                                {% endif %}
                            {% else %}
                                {% trans "unregistered" %}
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-sm-12 col-md-4 mt-1">
                            {% if question.answers_count %}
                                <span class="btn btn-sm btn-secondary mr-1">{% trans "Answered" %}</span>
                            {% else %}
                                <span class="btn btn-sm btn-danger mr-1">{% trans "Unanswered" %}</span>
                            {% endif %}
                            <span class="btn btn-sm btn-outline-secondary mr-1">
                                {{ question.get_category_display }}
                            </span>
                            {% if question.order %}
                                <a href="{% url 'rabop:order-detail' store.code question.order.id %}"
                                   class="btn btn-sm mr-2 btn-outline-info">
                                    {% trans "Order #" %}
                                </a>
                            {% endif %}
                        </div>
                        <div class="col-12 col-sm-12 col-md-6 mt-2"><strong>{{ question.title }}</strong></div>
                        <div class="col-12 col-sm-12 col-md-2 mt-2 text-muted text-md-right"
                             data-toggle="tooltip" data-placement="top" title="{{ question.created }}">
                            {{ question.created|date:'Y.m.d' }}
                        </div>
                    </div>
                </div>
                <div class="card-body pb-0">
                    {{ question.content|linebreaks }}
                </div>
            </div>
        </div>
    </div>
    <div class="row mb-2">
        <div class="col">
            {% for answer in question.answers.all %}
                <div class="card my-2">
                    <div class="card-header d-flex flex-wrap">
                        <div class="p-2">
                            # {{ forloop.counter }}
                        </div>
                        <div class="ml-auto p-2 text-muted"
                             data-toggle="tooltip" data-placement="top" title="{{ answer.created }}">
                            {{ answer.created|date:'Y.m.d' }}
                        </div>
                    </div>
                    <div class="card-body pb-0">
                        {{ answer.content|linebreaks }}
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    {% crispy form %}
    <a href="{% url 'rabop:question-list' store.code %}?page={{ request.GET.page }}"
       class="btn btn-outline-secondary btn-block btn-lg mb-4">
        <i class="fas fa-list-ul fa-fw" aria-hidden="true"></i>&nbsp;{% trans "List" %}
    </a>
{% endblock %}
